{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/Users/katvengo/prep-cado/App/Screens/ListingEditScreen.js\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState } from 'react';\nimport * as Yup from 'yup';\nimport { Storage } from 'aws-amplify';\nimport Amplify, { API, graphqlOperation } from '@aws-amplify/api';\nimport config from \"../../src/aws-exports\";\nAmplify.configure(config);\nimport useAuth from \"../Auth/useAuth\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport View from \"react-native-web/dist/exports/View\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport { AppForm, AppFormField, AppFormPicker, SubmitButton } from \"../Components/forms\";\nimport Screen from \"./Screen\";\nimport FormImagePicker from \"../Components/forms/FormImagePicker\";\nimport UploadScreen from \"./UploadScreen\";\nimport uploadRecipeFromImage from \"../Screens/UploadRecipeFromImage\";\nimport { createRecipe } from \"../../src/graphql/mutations\";\nimport { listRecipes } from \"../../src/graphql/queries\";\nvar validationSchema = Yup.object().shape({\n  name: Yup.string().required().min(1).label(\"Name\"),\n  description: Yup.string().min(1).max(1000).label(\"Description\"),\n  category: Yup.string().label(\"Category\"),\n  servings: Yup.string().label(\"Servings\"),\n  prepTime: Yup.string().label(\"Preparation Time\"),\n  cookTime: Yup.string().label(\"Cook Time\"),\n  ingredients: Yup.array().label(\"Ingredients\"),\n  directions: Yup.string().label(\"Directions\"),\n  images: Yup.array().min(1, \"Please select at least one image.\")\n});\n\nfunction ListingEditScreen() {\n  var _useAuth = useAuth(),\n      user = _useAuth.user,\n      logOut = _useAuth.logOut;\n\n  var sub = user.data.getUser.id;\n  console.log(sub);\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      uploadVisible = _useState2[0],\n      setUploadVisible = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      progress = _useState4[0],\n      setProgress = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      userImages = _useState6[0],\n      setUserImages = _useState6[1];\n\n  var imageArray = [];\n\n  var handleSubmit = function handleSubmit(recipe, _ref) {\n    var resetForm, images, i, element, resImage, blob, r;\n    return _regeneratorRuntime.async(function handleSubmit$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            resetForm = _ref.resetForm;\n            console.log(recipe, \"recipe\");\n            setProgress(0);\n            setUploadVisible(true);\n            _context.prev = 4;\n            images = recipe.images;\n            i = 0;\n\n          case 7:\n            if (!(i < images.length)) {\n              _context.next = 22;\n              break;\n            }\n\n            console.log(images);\n            element = images[i];\n            _context.next = 12;\n            return _regeneratorRuntime.awrap(fetch(element));\n\n          case 12:\n            resImage = _context.sent;\n            _context.next = 15;\n            return _regeneratorRuntime.awrap(resImage.blob());\n\n          case 15:\n            blob = _context.sent;\n            setProgress(i);\n            _context.next = 19;\n            return _regeneratorRuntime.awrap(Storage.put(recipeName + 'Image' + i + '.png', blob, {\n              contentType: 'image/png',\n              ACL: 'public-read',\n              progressCallback: function progressCallback(progress) {\n                console.log(\"Uploaded: \" + progress.loaded + \"/\" + progress.total);\n              }\n            }).then(function (result) {\n              var key = result.key;\n              var base = 'https://prepcadofc01ed34616c49d38896e4fc4c3a59ea124736-dev.s3.us-west-2.amazonaws.com/public/';\n              var imageURL = base + key;\n              imageArray.push(imageURL);\n            }).catch(function (err) {\n              return alert(err);\n            }));\n\n          case 19:\n            i++;\n            _context.next = 7;\n            break;\n\n          case 22:\n            console.log(imageArray);\n            recipe.images = imageArray;\n            console.log(recipe);\n            r = API.graphql(graphqlOperation(createRecipe, {\n              input: _objectSpread({\n                type: 'post'\n              }, recipe)\n            }, function (progress) {\n              return setProgress(progress);\n            }));\n\n            if (!r) {\n              console.log(r);\n              setUploadVisible(false);\n              alert('Could not save Recipe');\n            } else if (r) {\n              console.log(r);\n              setUploadVisible(false);\n              alert('Recipe updated successfully');\n              resetForm();\n            }\n\n            _context.next = 32;\n            break;\n\n          case 29:\n            _context.prev = 29;\n            _context.t0 = _context[\"catch\"](4);\n            console.log(_context.t0);\n\n          case 32:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, [[4, 29]], Promise);\n  };\n\n  return React.createElement(Screen, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 1\n    }\n  }, React.createElement(UploadScreen, {\n    onDone: function onDone() {\n      return setUploadVisible(false);\n    },\n    progress: progress,\n    visible: uploadVisible,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 1\n    }\n  }), React.createElement(ScrollView, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 2\n    }\n  }, React.createElement(AppForm, {\n    initialValues: {\n      name: '',\n      servings: '',\n      prepTime: '',\n      cookTime: '',\n      ingredients: [],\n      category: '',\n      cuisine: '',\n      description: '',\n      directions: '',\n      images: [],\n      url: '',\n      userId: sub\n    },\n    onSubmit: handleSubmit,\n    validationSchema: validationSchema,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 110,\n      columnNumber: 1\n    }\n  }, React.createElement(FormImagePicker, {\n    name: \"images\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 1\n    }\n  }), React.createElement(AppFormField, {\n    maxLength: 255,\n    placeholder: \"Name\",\n    name: \"name\",\n    autoFocus: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 1\n    }\n  }), React.createElement(AppFormField, {\n    maxLength: 255,\n    multiline: true,\n    placeholder: \"Description\",\n    name: \"description\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 1\n    }\n  }), React.createElement(AppFormField, {\n    multiline: true,\n    name: \"category\",\n    placeholder: \"Category: Meat, seafood, chicken, freezer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 2\n    }\n  }), React.createElement(AppFormField, {\n    maxLength: 255,\n    multiline: true,\n    placeholder: \"Cuisine\",\n    name: \"cuisine\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 1\n    }\n  }), React.createElement(AppFormField, {\n    maxLength: 255,\n    placeholder: \"Servings\",\n    name: \"servings\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 1\n    }\n  }), React.createElement(AppFormField, {\n    maxLength: 255,\n    placeholder: \"Preparation Time\",\n    name: \"prepTime\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 1\n    }\n  }), React.createElement(AppFormField, {\n    maxLength: 255,\n    placeholder: \"Cooking Time\",\n    name: \"cookTime\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164,\n      columnNumber: 1\n    }\n  }), React.createElement(AppFormField, {\n    multiline: true,\n    numberOfLines: 2,\n    maxLength: 600,\n    placeholder: \"Ingredients\",\n    name: \"ingredients\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 169,\n      columnNumber: 1\n    }\n  }), React.createElement(AppFormField, {\n    multiline: true,\n    maxLength: 255,\n    placeholder: \"Directions\",\n    name: \"directions\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 1\n    }\n  }), React.createElement(AppFormField, {\n    multiline: true,\n    numberOfLines: 2,\n    maxLength: 600,\n    placeholder: \"Reference url\",\n    name: \"url\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 2\n    }\n  }), React.createElement(View, {\n    style: styles.submit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 1\n    }\n  }, React.createElement(SubmitButton, {\n    title: \"Add\",\n    size: 300,\n    radius: 10,\n    fontSize: 18,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 3\n    }\n  })))));\n}\n\nvar styles = StyleSheet.create({\n  container: {\n    padding: 20\n  },\n  submit: {\n    justifyContent: 'center',\n    alignSelf: 'center'\n  }\n});\nexport default ListingEditScreen;","map":{"version":3,"sources":["/Users/katvengo/prep-cado/App/Screens/ListingEditScreen.js"],"names":["React","useEffect","useState","Yup","Storage","Amplify","API","graphqlOperation","config","configure","useAuth","AppForm","AppFormField","AppFormPicker","SubmitButton","Screen","FormImagePicker","UploadScreen","uploadRecipeFromImage","createRecipe","listRecipes","validationSchema","object","shape","name","string","required","min","label","description","max","category","servings","prepTime","cookTime","ingredients","array","directions","images","ListingEditScreen","user","logOut","sub","data","getUser","id","console","log","uploadVisible","setUploadVisible","progress","setProgress","userImages","setUserImages","imageArray","handleSubmit","recipe","resetForm","i","length","element","fetch","resImage","blob","put","recipeName","contentType","ACL","progressCallback","loaded","total","then","result","key","base","imageURL","push","catch","err","alert","r","graphql","input","type","styles","container","cuisine","url","userId","submit","StyleSheet","create","padding","justifyContent","alignSelf"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport * as Yup from 'yup'\nimport { Storage} from 'aws-amplify';\nimport Amplify, { API,  graphqlOperation } from '@aws-amplify/api';\nimport config from '../../src/aws-exports'\nAmplify.configure(config)\nimport useAuth from \"../Auth/useAuth\";\n\nimport { StyleSheet, View, ScrollView} from 'react-native'\nimport { AppForm, AppFormField, AppFormPicker, SubmitButton } from '../Components/forms'\nimport Screen from './Screen'\nimport FormImagePicker from '../Components/forms/FormImagePicker'\n//import useLocation from \"../hooks/useLocation\";\nimport UploadScreen from \"./UploadScreen\";\nimport uploadRecipeFromImage from '../Screens/UploadRecipeFromImage';\n\nimport { createRecipe } from '../../src/graphql/mutations'\nimport { listRecipes } from '../../src/graphql/queries'\n\n\nconst validationSchema = Yup.object().shape({\n    name: Yup.string().required().min(1).label(\"Name\"),\n    description: Yup.string().min(1).max(1000).label(\"Description\"),\n    category: Yup.string().label(\"Category\"),\n    servings: Yup.string().label(\"Servings\"),\n    prepTime: Yup.string().label(\"Preparation Time\"),\n    cookTime: Yup.string().label(\"Cook Time\"),\n    ingredients: Yup.array().label(\"Ingredients\"),\n    directions: Yup.string().label(\"Directions\"),\n    images: Yup.array().min(1, \"Please select at least one image.\"),\n    \n})\n\n\nfunction ListingEditScreen () { \nconst { user, logOut } = useAuth();\nlet sub = user.data.getUser.id\nconsole.log(sub)\n//const location = useLocation();\nconst [uploadVisible, setUploadVisible] = useState(false);\nconst [progress, setProgress] = useState(0);\nconst [userImages, setUserImages] = useState([])\n\nconst imageArray = []\n\nconst handleSubmit = async (recipe, { resetForm } ) => {\n    console.log(recipe, \"recipe\")\n    setProgress(0);\n    setUploadVisible(true);\n    try {\n        const images = recipe.images\n        \n       // const recipeName = recipe.name.replace(\"[ ]+\",\"g\", '')\n\n        for (let i = 0; i < images.length; i++) {\n            console.log(images)\n            const element = images[i];\n            const resImage = await fetch(element)\n            const blob = await resImage.blob()\n            setProgress(i)\n            await Storage.put(recipeName + 'Image' + i + '.png', blob, {\n                contentType: 'image/png',\n                ACL: 'public-read',\n                progressCallback(progress) {\n                   console.log(`Uploaded: ${progress.loaded}/${progress.total}`);\n                  },\n            })\n            .then (result => \n                {\n                    const key = result.key\n                    const base = 'https://prepcadofc01ed34616c49d38896e4fc4c3a59ea124736-dev.s3.us-west-2.amazonaws.com/public/'\n                    const imageURL = base + key\n                    imageArray.push(imageURL)\n                }\n                )\n            .catch(err => alert(err)\n            );   \n        }\n        console.log(imageArray)\n        recipe.images = imageArray\n        console.log(recipe)\n\n        const r = API.graphql(graphqlOperation(createRecipe, {input: {type: 'post', ...recipe}}, (progress) => setProgress(progress)))\n                if(!r) {\n                console.log(r)\n                setUploadVisible(false);\n                alert('Could not save Recipe')\n                } else if (r){\n                console.log(r)\n                setUploadVisible(false);\n                alert('Recipe updated successfully')\n                resetForm();\n\n\n            }\n      } catch (err) {\n        console.log(err)\n      }\n    \n}\n\nreturn ( \n<Screen style={styles.container}>\n<UploadScreen\n        onDone={() => setUploadVisible(false)}\n        progress={progress}\n        visible={uploadVisible}\n      />\n <ScrollView>\n<AppForm\ninitialValues={{\n    name: '', \n    servings: '', \n    prepTime: '', \n    cookTime: '', \n    ingredients: [], \n    category: '', \n    cuisine: '',\n    description: '',\n    directions: '',\n    images: [],\n    url: '',\n    userId: sub\n}\n}\nonSubmit={handleSubmit}\nvalidationSchema={validationSchema}\n>\n<FormImagePicker name=\"images\" />\n<AppFormField\nmaxLength={255}\nplaceholder=\"Name\"\nname=\"name\"\nautoFocus={true}\n />\n\n<AppFormField\nmaxLength={255}\nmultiline\nplaceholder=\"Description\"\nname=\"description\"\n />\n <AppFormField\nmultiline\nname=\"category\"\nplaceholder=\"Category: Meat, seafood, chicken, freezer\"\n/>\n<AppFormField\nmaxLength={255}\nmultiline\nplaceholder=\"Cuisine\"\nname=\"cuisine\"\n />\n<AppFormField\nmaxLength={255}\nplaceholder=\"Servings\"\nname=\"servings\"\n />\n<AppFormField\nmaxLength={255}\nplaceholder=\"Preparation Time\"\nname=\"prepTime\"\n />\n<AppFormField\nmaxLength={255}\nplaceholder=\"Cooking Time\"\nname=\"cookTime\"\n />\n<AppFormField\n multiline={true}\nnumberOfLines={2}\nmaxLength={600}\nplaceholder=\"Ingredients\"\nname=\"ingredients\"\n />\n<AppFormField\n multiline={true}\nmaxLength={255}\nplaceholder=\"Directions\"\nname=\"directions\"\n />\n <AppFormField\n multiline={true}\nnumberOfLines={2}\nmaxLength={600}\nplaceholder=\"Reference url\"\nname='url' \n/>\n<View style={styles.submit}>\n  <SubmitButton title=\"Add\" size={300} radius={10} fontSize={18}/>\n</View>\n</AppForm>\n</ScrollView>\n</Screen>\n\n);\n}\n\nconst styles = StyleSheet.create({\n    container: {\n        padding: 20\n    },\n    submit: {\n        justifyContent: 'center',\n        alignSelf: 'center'\n    }\n\n})\nexport default ListingEditScreen"]},"metadata":{},"sourceType":"module"}